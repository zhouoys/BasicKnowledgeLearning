# 笔记

## 事件介绍

**事件产生**

+ 小程序需要经常和用户进行某种<font color="red">交互</font>，比如点击界面上的某个按钮或者区域，比如滑动了某个区域；
+ 这些交互都会产生各种各样的<font color="red">事件</font>

**事件时如何处理**

+ 事件是通过<font color="red">bind/catch</font>这个属性绑定在组件上的（和普通的属性写法很相似，以key = 'value'形式）；
+ key以bind或者catch开发，从1.5.0版本开始，可以在bind或catch后面添加一个冒号
+ 同时在当前页面的Page构造器中定义对应的事件处理函数tapName,如果没有对应的函数，触发事件时会报错
+ 当用户点击该button区域时，达到触发条件生成事件tap,该事件处理函数tapName会被执行，同时还会收到一个事件对象<font color="red">event</font>



## 事件简单演练

![image-20200531205932251](08_事件处理.assets/image-20200531205932251.png)



## 常见事件类型

**某些组件**会有自己特性的事件类型

+ 比如<font color="red">input</font>有<font color="red">bindinput</font> / <font color="red">bindfocus</font>等
+ 比如<font color="red">scroll-view</font>有<font color="red">bindscrolltowpper</font> / <font color="red">bindscrolltolower</font>等

**这里列出<font color="red">几个组件都有</font>的，并且<font color="red">比较常见的事件类型</font>**



| 类型        | 触发条件                                                     |
| ----------- | ------------------------------------------------------------ |
| touchstart  | 手指触摸动作开始                                             |
| touchmove   | 手指触摸后移动                                               |
| touchcancel | 手指触摸动作被打断，如来电提醒，弹窗                         |
| touchend    | 手指触摸动作结束                                             |
| tap         | 手指触摸后马上离开                                           |
| longpress   | 手指触摸后，超多350ms再离开，如果指定了事件回调<br />函数并且触发了这个事件，tap事件将不再触发 |
| longtap     | 手指触摸后，超过350ms再离开（推荐使用longpress替代）         |



## 事件类型演练

![image-20200531211454459](08_事件处理.assets/image-20200531211454459.png)

**两个注意点**

+ <font color="red">Touchcancle</font>:在特定场景下才会触发（比如来电打断）。

+ <font color="red">tap事件</font>和<font color="red">longpress</font>事件通常只会触发其中一个。



![image-20200603141128550](08_事件处理.assets/image-20200603141128550.png)



## 事件对象介绍

**当某个事件触发时，会产生一个<font color="red">事件对象</font>**，并且这个对象被传入到回调函数中，事件对象有哪些常见的属性呢？

| 属性           | 类型    | 说明                                         |
| -------------- | ------- | -------------------------------------------- |
| type           | String  | 事件类型                                     |
| timeStamp      | Integer | 页面打开到触发事件所经历的毫秒数             |
| target         | Object  | 触发事件的组合的一些属性值集合               |
| currentTarget  | Object  | 当前组件的一些属性值集合                     |
| detail         | Object  | 额外的信息                                   |
| touches        | Array   | 触摸事件，当前停留在屏幕中的触摸点信息的数组 |
| changedTouches | Array   | 触摸事件，当前变化的触摸点信息的数组         |



![image-20200603141648049](08_事件处理.assets/image-20200603141648049.png)





### touches和changedTouches的区别

1. 在touchend中不同
2. 多手指触摸时不同



![image-20200531213534342](08_事件处理.assets/image-20200531213534342.png)



![image-20200603142401150](08_事件处理.assets/image-20200603142401150.png)





![image-20200603142616660](08_事件处理.assets/image-20200603142616660.png)





![image-20200603142728277](08_事件处理.assets/image-20200603142728277.png)





### currentTarget和target的区别



![image-20200531213706915](08_事件处理.assets/image-20200531213706915.png)





![image-20200603143443192](08_事件处理.assets/image-20200603143443192.png)





## 事件参数的传递

当视图层发生事件时，某些情况需要事件携带一些参数到执行的函数中，这个时候就可以通过<font color="red">data-属性</font>来完成：

格式：<font color="red">data-属性</font>的名称

获取：<font color="red">e.currentTarget.dataset.属性</font>的名称

![image-20200531214356867](08_事件处理.assets/image-20200531214356867.png)



### 参数传递的练习



![image-20200531214453153](08_事件处理.assets/image-20200531214453153.png)





![image-20200603143937606](08_事件处理.assets/image-20200603143937606.png)





![image-20200603144058075](08_事件处理.assets/image-20200603144058075.png)





## 事件冒泡和事件捕获

当界面产生了一个事件时，事件分为了<font color="red">事件捕获阶段</font>和<font color="red">事件冒泡阶段</font>

![image-20200531214805602](08_事件处理.assets/image-20200531214805602.png)

### 代码演练



![image-20200531214851019](08_事件处理.assets/image-20200531214851019.png)





![image-20200603144426904](08_事件处理.assets/image-20200603144426904.png)





![image-20200603144502184](08_事件处理.assets/image-20200603144502184.png)





![image-20200603150638758](08_事件处理.assets/image-20200603150638758.png)





![image-20200603150928845](08_事件处理.assets/image-20200603150928845.png)



